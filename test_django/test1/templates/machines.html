<!DOCTYPE html>
<html lang="en">
   <head>
      <title>Enviros</title>
      {% load staticfiles %}
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
      <link rel="stylesheet" href="{% static '/css/style.css' %}" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600,200italic,600italic&subset=latin,vietnamese' rel='stylesheet' type='text/css'>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/jquery/dist/jquery.min.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/d3/d3.min.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/d3-transform/src/d3-transform.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/cafej/src/extarray.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/cafej/src/misc.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/cafej/src/micro-observer.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/microplugin/src/microplugin.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/bubble-chart/src/bubble-chart.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/bubble-chart/src/plugins/central-click/central-click.js"></script>
      <script src="http://phuonghuynh.github.io/js/bower_components/bubble-chart/src/plugins/lines/lines.js"></script>
      <script src="https://code.highcharts.com/highcharts.js"></script>
      <script src="https://code.highcharts.com/modules/data.js"></script>
      <script src="https://code.highcharts.com/modules/drilldown.js"></script>
      <style>
         /*.bubbleChart {
         min-width: 100px;
         max-width: 700px;
         height: 700px;
         margin: 0 auto;
         }
         .bubbleChart svg{
         background: #000000;
         }*/
         .responsive {
         width: 80%;
         height: auto;
         }
         .carousel-inner img {
         width: 100%;
         height: 100%;
         padding: 40px 10px 80px 10px;
         }
         footer.footer {
         padding-top: 4rem;
         padding-bottom: 4rem;
         } 
      </style>
     <!--  <script type="text/javascript">
         spingraph();
         // bubble_graph();
         function spingraph(){
           //realtime usage
           $.ajax({
          url:"./dashb.php",
          type:"POST",
           data: {type:"spingraph"},
          success:function(data){
            var obj = JSON.parse(data);
            console.log(obj);
            $(".counter").append(obj);
            // $("#spinnerError").css('display','none');
            // $("#spinner1Layer").css('display','block');
         }
         });
         $.ajax({
           url:"./dashb.php",
           type:"POST",
           data: {type:"horizantal_bargraph"},
           success:function(data){
            var obj = JSON.parse(data);
            console.log(data);
            $(".estimated_value").append(obj);
           }
           });
         $.ajax({
           url:"./dashb.php",
           type:"POST",
           data: {type:"target"},
           success:function(data){
            var obj = JSON.parse(data);
            console.log(obj);
            $(".spent_value").append(obj);
           }
           });
         }
         
      </script> -->
      

   </head>
   <body>
      <nav class="navbar navbar-expand-md bg-primary navbar-dark">
         <a class="navbar-brand" href="#">Enviros</a>
         <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
         <span class="navbar-toggler-icon"></span>
         </button>
         <div class="collapse navbar-collapse" id="collapsibleNavbar">
            <ul class="navbar-nav" >
               <li class="nav-item">
                  <a class="nav-link" href="#">Home</a>
               </li>
               <li class="nav-item">
                  <a class="nav-link" href="#">Buy Products</a>
               </li>
               <li class="nav-item">
                  <a class="nav-link" href="#">About</a>
               </li>
               <li class="nav-item">
                  <a class="nav-link" href="#">Help</a>
               </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">{{ name }}</a>
               </li>

            </ul>
         </div>
      </nav>
      <div class="container">
      </div>
      <div class="col-md-3">
         <div class="panel">
            <h1></h1>
         </div>
      </div>
      <div class="col-md-3">
         <div class="panel">
            <h1></h1>
         </div>
      </div>
      <div class="container">
         <div class="row">

 <div class="col-md-12 text-left">
            <h5> SelectMachine </h5>
             <form style="width:32%" name="mymultiselect" id="mymultiselect" action="/get_check" method="POST">
             
                       <!--  
                        <select id="lstFruits" multiple="multiple" >
                          <option value="1" selected="selected"> Machine 1</option>
                          <option value="2">Machine 2</option>
                          <option value="3">Machine 3</option>
                          <option value="4">Machine 4</option>
                          <option value="5">Machine 5</option>
                        </select>
                    -->
                    <select id="lstFruits" multiple="multiple" class="form-control" name="mymultiselect" style="position: inherit;" onchange="fun1()">
                         <!--  <option value="Machine_1" selected="selected"> Machine 1</option>
                          <option value="Machine_2">Machine 2</option>
                          <option value="Machine_3">Machine 3</option> -->
                          <!-- <option value="Machine4">Machine 4</option>
                          <option value="Machine5">Machine 5</option> -->
                          {% for entry in list1 %}
                              <option value="{{ entry }}">{{ entry }}</option>
                              
                              {% endfor %}


                        </select>
                
                 
                 
                 
                </form><br>
            
            
          </div>

         


            <div class="col-sm">
               <div class="card bg-light text-dark" style="width:98%; height:98% ;border-color:#c9cbcc; border-width: 2px;border-radius: 3%;">
                  <div class="card-body">
                     Real-time Usage
                     <div class="para">
                        <img id="loading" src="https://engage.efergy.com/widgets/EHRealtimeMC/images/spinner1.png">
                        <div class="centered" style="color:#fff">
                           <h1 class="counter" style="color:DodgerBlue;"></h1>
                           
                           <h5>KWH</h5>
                        </div>
                     </div>
                     <br>
                     <div class="container"><p><a class="btn btn-outline-primary btn-sm" href="www.google.com" >Power</a> <button class="btn btn-outline-primary btn-sm">Current</button></p></div>
                  </div>
               </div>
            </div>
            <div class="col-sm">
               <div class="card bg-light text-dark" style="width:98%; height:98% ; border-color:#c9cbcc; border-width: 2px;border-radius: 3%;">
                  <div class="card-body">
                     Budget
                     <div class="card-body">
                        Spent so far
                        <a>
                           <h3 class="spent_value" style="color:#39ab5a">₹100</h3>
                        </a>
                        <div class="progress" style="height:40px;border-radius:10px" >
                           <div class="progress-bar bg-success progress-bar-striped progress-bar-animated" style="width:40%"></div>
                           <div class="progress-bar bg-warning progress-bar-striped progress-bar-animated" style="width:40%"></div>
                        </div>
                        <br>
                        <a>
                           Estimated
                           <h3 class="estimated_value" style="color:#ffcc3d">₹</h3>
                        </a>
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-sm">
               <div class="card bg-light text-dark" style="width:98%; height:98%; border-color:#c9cbcc; border-width: 2px;border-radius: 3%;">
                  <div class="card-body">
                     Cost so far </br>
                     <!-- <span class="bubbleChart" id="bubbleChart"></span> -->
                     <div id="demo" class="carousel" data-ride="" style="width: 300px; height: 300px; background: ;">
                        <!-- The slideshow -->
                        <div class="carousel-inner">
                           <div class="carousel-item active">
                              <img src="{% static '/imgs/cost_1_bg.png' %}" alt="Los Angeles" width="1100" height="500">
                              <div class="carousel-caption" style="padding: 140px 5px">
                                 <h2>₹ 503</h2>
                                 <p>This Month</p>
                              </div>
                           </div>
                           <div class="carousel-item">
                              <img src="{% static '/imgs/cost_2_bg.png' %}" alt="Chicago" width="1100" height="500">
                              <div class="carousel-caption" style="padding: 140px 5px">
                                 <h2>₹ 45</h2>
                                 <p>Today</p>
                              </div>
                           </div>
                           <div class="carousel-item">
                              <img src="{% static '/imgs/cost_3_bg.png' %}" alt="New York" width="1100" height="500">
                              <div class="carousel-caption" style="padding: 120px 5px">
                                 <h2>₹ 1520</h2>
                                 <p>Since<br>25-11-2018</p>
                              </div>
                           </div>
                        </div>
                        <!-- Left and right controls -->
                        <a class="carousel-control-prev" href="#demo" data-slide="prev" style="width:100px;padding: 40px 20px 40px 10px;">
                        <span class="">Since</span>
                        </a>
                        <a class="carousel-control-next" href="#demo" data-slide="next" style="width:100px;padding: 40px 20px 40px 10px;">
                           <span class="past">
                              <h5>Today</h5>
                           </span>
                        </a>
                     </div>
                  </div>
                  <!-- <span class="bubbleChart">uyuhk</span> -->
               </div>
               <!-- <span class="bubbleChart">uyuhk</span> -->
            </div>
         </div>
         <br>
         <div class="row">
            <div class="col-md">
               <div class="card bg-light text-dark" style="width:99%; height:99% ; border-color:#c9cbcc; border-width: 2px;border-radius: 1%;">
                  <div class="card-body" >
                     Energy demand
                     <!-- style="text-align: center;" -->
                     <div id="graph" class="meter_alignmment"></div>
                     <!--  <div id="energy">Energy Demand</div>
                        <canvas id="c" width="550" height="250" class="responsive"></canvas>
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>
                        <script>
                        var ctx = document.getElementById("c").getContext("2d");
                        var data = {
                        labels: ["January", "February", "March", "April", "May", "June", "July"],
                        datasets: [{
                        label: "My First dataset",
                        fillColor: "rgba(220,220,220,0.2)",
                        strokeColor: "rgba(220,220,220,1)",
                        pointColor: "rgba(220,220,220,1)",
                        pointStrokeColor: "#fff",
                        pointHighlightFill: "#fff",
                        pointHighlightStroke: "rgba(220,220,220,1)",
                        data: [65, 59, 80, 81, 56, 55, 40]
                        }, {
                        label: "My Second dataset",
                        fillColor: "rgba(151,187,205,0.2)",
                        strokeColor: "rgba(151,187,205,1)",
                        pointColor: "rgba(151,187,205,1)",
                        pointStrokeColor: "#fff",
                        pointHighlightFill: "#fff",
                        pointHighlightStroke: "rgba(151,187,205,1)",
                        data: [28, 48, 40, 19, 86, 27, 90]
                        }]
                        };
                        var MyNewChart = new Chart(ctx).Line(data);
                        </script> -->
                  </div>
               </div>
            </div>
         </div>
         <br>
         <div class="row">
            <div class="col-md">
               <div class="card bg-light text-dark" style="width:99%; height:99% ; border-color:#c9cbcc; border-width: 2px;border-radius: 1%;">
                  <div class="card-body">History Usage</div>
                  <div id="histogram1" style="margin-top: 10px;"></div>
               </div>
            </div>
         </div>
         <br>
         <!-- Footer -->
         <footer class="footer bg-light">
            <div class="container">
               <div class="row">
                  <div class="col-lg-6 h-100 text-center text-lg-left my-auto">
                     <ul class="list-inline mb-2">
                        <li class="list-inline-item">
                           <a href="#">About</a>
                        </li>
                        <li class="list-inline-item">&sdot;</li>
                        <li class="list-inline-item">
                           <a href="#">Contact</a>
                        </li>
                        <li class="list-inline-item">&sdot;</li>
                        <li class="list-inline-item">
                           <a href="#">Terms of Use</a>
                        </li>
                        <li class="list-inline-item">&sdot;</li>
                        <li class="list-inline-item">
                           <a href="#">Privacy Policy</a>
                        </li>
                     </ul>
                     <p class="text-muted small mb-4 mb-lg-0">&copy; Enviros 2018. All Rights Reserved.</p>
                  </div>
                  <div class="col-lg-6 h-100 text-center text-lg-right my-auto">
                     <ul class="list-inline mb-0">
                        <li class="list-inline-item mr-3">
                           <a href="#">
                           <i class="fa fa-facebook"></i>
                           </a>
                        </li>
                        <li class="list-inline-item mr-3">
                           <a href="#">
                           <i class="fa fa-twitter"></i>
                           </a>
                        </li>
                        <li class="list-inline-item">
                           <a href="#">
                           <i class="fa fa-instagram"></i>
                           </a>
                        </li>
                        <li class="list-inline-item">
                           <a href="#">
                           <i class="fa fa-linkedin"></i>
                           </a>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </footer>
      </div>
      <script type="text/javascript">
         function bubble_graph(){
         // document.getElementById("bubbleChart").innerHTML="ijki";
         // $(".bubbleChart").append("obj");
         var bubbleChart = new d3.svg.BubbleChart({
           supportResponsive: true,
           //container: => use @default
           size: 250,
           //viewBoxSize: => use @default
           innerRadius: 250 / 3.5,
           //outerRadius: => use @default
           radiusMin: 25,
           //radiusMax: use @default
           //intersectDelta: use @default
           //intersectInc: use @default
           //circleColor: use @default
           data: {
             items: [
               {text: "This month", count: "236"},
               {text: "since", count: "382"},
               {text: "Today", count: "170"},
             ],
             eval: function (item) {return item.count;},
             classed: function (item) {return item.text.split(" ").join("");}
           },
           plugins: [
             {
               name: "central-click",
               options: {
                 // text: "(See more detail)",
                 style: {
                   "font-size": "12px",
                   "font-style": "italic",
                   "font-family": "Source Sans Pro, sans-serif",
                   //"font-weight": "700",
                   "text-anchor": "middle",
                   "fill": "white"
                 },
                 attr: {dy: "65px"},
                 centralClick: function() {
                   //alert("Here is more details!!");
                 }
               }
             },
             {
               name: "lines",
               options: {
                 format: [
                   {// Line #0
                     textField: "count",
                     classed: {count: true},
                     style: {
                       "font-size": "28px",
                       "font-family": "Source Sans Pro, sans-serif",
                       "text-anchor": "middle",
                       fill: "white"
                     },
                     attr: {
                       dy: "0px",
                       x: function (d) {return d.cx;},
                       y: function (d) {return d.cy;}
                     }
                   },
                   {// Line #1
                     textField: "text",
                     classed: {text: true},
                     style: {
                       "font-size": "14px",
                       "font-family": "Source Sans Pro, sans-serif",
                       "text-anchor": "middle",
                       fill: "white"
                     },
                     attr: {
                       dy: "20px",
                       x: function (d) {return d.cx;},
                       y: function (d) {return d.cy;}
                     }
                   }
                 ],
                 centralFormat: [
                   {// Line #0
                     style: {"font-size": "50px"},
                     attr: {}
                   },
                   {// Line #1
                     style: {"font-size": "30px"},
                     attr: {dy: "40px"}
                   }
                 ]
               }
             }]
         });
         }
         function histogram(){
          //alert("hch")
         var chart = Highcharts.chart('histogram1', {
         
         title: {
         text: 'History usage'
         },
         
         xAxis: {
         categories: []
         },
         yAxis: {
         title: {
           text: 'KWh'
         },
         },
         
         series: [{
         type: 'column',
         colorByPoint: true,
         data: [],
         showInLegend: false
         }]
         
         });
         months = [];
         prdctn =[10,20,30,40,50,60,70];
         month_list = ['January', 'February', 'March', 'April', 'May','June', 'July', 'August', 'September','October', 'November', 'December'];
         // $.ajax({
         // url:"./dashb.php",
         // type:"POST",
         // data: {type:"monthly",year:'2018'},
         // success:function(data){
         // console.log(data);
         // var obj = JSON.parse(data);
         // for(i=0;i<obj.length;i++){
         // months.push(month_list[(obj[i].month) - 1]);
         // prdctn.push(parseInt(obj[i].production));
         // }
         chart.xAxis[0].setCategories(month_list, true, true);
         chart.series[0].setData(eval(prdctn), true, true);
         // }
         // });
         
         }
         function spline(){
         Highcharts.setOptions({
         global: {
         useUTC: false
         }
         });
         var spline = Highcharts.chart('graph', {
         chart: {
         type: 'spline',
         animation: Highcharts.svg, // don't animate in old IE
         events: {
             load: function () {
         
                 // set up the updating of the chart each second
                 var series1 = this.series[0];
                 loadGraphSeries1(series1);
               //   setInterval(function () {
               //     loadGraphSeries1(series1);
               // }, 10000);
                  var series2 = this.series[1];
                  loadGraphSeries2(series2);
                //   setInterval(function () {
                //     loadGraphSeries2(series2);
                // }, 10000);
             }
         
         }
         },
         title: {
         text: 'Energy Demand'
         },
         xAxis: {
         type: '',
         tickPixelInterval: 150,
         tickInterval: 1000 * 60
         },
         yAxis: {
         title: {
             text: 'KW'
         },
         plotLines: [{
             value: 0,
             width: 1,
             color: '#808080'
         }]
         },
         tooltip: {
         formatter: function () {
             return '<b>' + this.series.name + '</b><br/>' +
                 Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '<br/>' +
                 Highcharts.numberFormat(this.y, 2);
         }
         },
         legend: {
         enabled: false
         },
         exporting: {
         enabled: false
         },
         series: [{
         name: 'Temperature',
         data: [10,20,30,40,50,60]
         },
         {
         name: 'Humidity',
         data: [10,20,30,40,50,60]
         }]
         });
         Highcharts.setOptions({
         global: {
         useUTC: false
         }
         });
         // loadGraphSeries1(spline.series[0]);
         // loadGraphSeries2(spline.series[1]);
         }
         // function loadGraphSeries1(series1){
         // // $.ajax({
         // // url:"./dashb.php",
         // // type:"POST",
         // // data: {type:"sensor_1"},
         // // success:function(data){
         // // console.log(data)
         // //   var obj = JSON.parse(data);
         // //   var a=[];
         // // var b=[];
         // // for(i=0; i<obj.length;i++){
         // // a.push(obj[i]['time']);
         // // a.push(obj[i]['temp']);
         // // b.push(a)
         // // a=[];
         // // }
         // // for(var i=0; i<b.length; i++) {
         // //     for(var j=0; j<2;j++){
         // //     b[i][j] = parseInt(b[i][j], 10); }}
         // // // console.log(b);
         // // console.log(series1.setData(eval(b), true,true));
         // // }
         // // });
         // }
         // function loadGraphSeries2(series2){
         // $.ajax({
         // url:"./dashb.php",
         // type:"POST",
         // data: {type:"sensor_1"},
         // success:function(data){
         //   var obj = JSON.parse(data);
         //   var a=[];
         // var b=[];
         // for(i=0; i<obj.length;i++){
         // a.push(obj[i]['time']);
         // a.push(obj[i]['humidity']);
         // b.push(a)
         // a=[];
         // }
         // for(var i=0; i<b.length; i++) {
         //    for(var j=0; j<2;j++){
         //    b[i][j] = parseInt(b[i][j], 10); }}
         // // console.log(b);
         // console.log(series2.setData(eval(b), true,true));
         // }
         // });
         // }
         function high_spline(){ 
            x = {{ list3 }};
         
         Highcharts.chart('graph', {
         chart: {
         height:250,
         type: 'areaspline'
         },
         title: {
         text: '< 5 December 2018'
         },
         legend: {
         layout: 'vertical',
         align: 'left',
         verticalAlign: 'top',
         x: 150,
         y: 100,
         floating: true,
         borderWidth: 1,
         backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'
         },
         xAxis: {
         categories: [
             // 'Monday',
             // 'Tuesday',
             // 'Wednesday',
             // 'Thursday',
             // 'Friday',
             // 'Saturday',
             // 'Sunday'
             '24','03','06','09','12','15','18'
         ],
         // plotBands: [{ // visualize the weekend
         //     from: 4.5,
         //     to: 6.5,
         //     color: 'rgba(68, 170, 213, .2)'
         // }]
         },
         yAxis: {
         title: {
             text: 'Kwh'
         }
         },
         tooltip: {
         shared: true,
         valueSuffix: ' units'
         },
         credits: {
         enabled: false
         },
         plotOptions: {
         areaspline: {
             fillOpacity: 0.5
         }
         },
         series: [{
         name: 'Power',
         data: x
         }, {
         name: 'Current',
         data: [1, 3, 4, 3, 3, 5, 4]
         }]
         });
         }
         histogram();
         high_spline();
         // spline();
         bubble_graph();
         
         // loadGraphSeries1(spline.series[0]);
         // loadGraphSeries2(spline.series[1]);
      </script>

      <script src="{% static '/js/jquery-1.8.2.min.js' %}"></script>
<script src="{% static '/js/bootstrap.min.js' %}"></script>

<!-- <script src="static/plugins/datatables/jquery.dataTables.min.js"></script> -->
<!-- <script src="static/plugins/datatables/dataTables.bootstrap.min.js"></script> -->
<link href="http://cdn.rawgit.com/davidstutz/bootstrap-multiselect/master/dist/css/bootstrap-multiselect.css"
rel="stylesheet" type="text/css" />
<script src="{% static '/js/multiselect.js' %}"></script>
<script type="text/javascript">
        $(function () {
            $('#lstFruits').multiselect({
                includeSelectAllOption: true
            });
           
        });
    </script>
    {% block scripts %}
<script type="text/javascript">
$(document).ready(function(){ 
   $.ajax({
   url : '/wheel/',
   type:'GET',
   dataType: "json",
   data: {},
   success:function(data){
   console.log("sss");
   console.log(data.power);
   $('.counter').html(data.power);
}
})
})
// $('#name').html("data");
</script>
{% endblock %}
   </body>
</html>